{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport { recentBookISBNs } from \"../data/recentBooks\";\n\n// openBD API„ÅÆ„É¨„Çπ„Éù„É≥„ÇπÂûãÂÆöÁæ©\n\nexport function useRecentBooks() {\n  _s();\n  const [books, setBooks] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    const fetchBooks = async () => {\n      if (recentBookISBNs.length === 0) {\n        setIsLoading(false);\n        return;\n      }\n      try {\n        setIsLoading(true);\n        setError(null);\n\n        // openBD API„ÇíÂëº„Å≥Âá∫„ÅóÔºàISBN„Çí„Ç´„É≥„ÉûÂå∫Âàá„Çä„ÅßÊåáÂÆöÔºâ\n        const isbnQuery = recentBookISBNs.join(\",\");\n        console.log(\"üìö Êõ∏Á±ç„Éá„Éº„ÇøÂèñÂæóÈñãÂßã - ISBN:\", isbnQuery);\n        const response = await fetch(`https://api.openbd.jp/v1/get?isbn=${isbnQuery}`);\n        if (!response.ok) {\n          throw new Error(`API„É™„ÇØ„Ç®„Çπ„Éà„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ${response.statusText}`);\n        }\n        const data = await response.json();\n        console.log(\"üìö API„É¨„Çπ„Éù„É≥„Çπ:\", data);\n\n        // null„ÉÅ„Çß„ÉÉ„ÇØ„Å®„Éá„Éº„Çø„ÅÆÊï¥ÂΩ¢\n        const validData = data.filter(item => item !== null);\n        if (validData.length === 0) {\n          console.warn(\"‚ö†Ô∏è ÂèñÂæó„Åó„Åü„Éá„Éº„Çø„Åå„Åô„Åπ„Å¶null„Åß„Åô„ÄÇISBN„Ç≥„Éº„Éâ„ÅåÊ≠£„Åó„ÅÑ„Åã„ÄÅopenBD„Å´„Éá„Éº„Çø„ÅåÂ≠òÂú®„Åô„Çã„ÅãÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ\");\n          setError(`ISBN„Ç≥„Éº„Éâ ${isbnQuery} „ÅÆÊõ∏Á±çÊÉÖÂ†±„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ`);\n          setBooks([]);\n          return;\n        }\n\n        // „Éá„Éº„Çø„ÇíÊï¥ÂΩ¢\n        const bookList = validData.map(item => {\n          var _item$onix, _item$onix$Collateral, _item$onix$Collateral2, _item$onix$Collateral3;\n          const summary = item.summary;\n          console.log(\"üìñ Êõ∏Á±çÊÉÖÂ†±:\", summary);\n          return {\n            isbn: summary.isbn || \"\",\n            title: summary.title || \"\",\n            author: summary.author || \"\",\n            publisher: summary.publisher || \"\",\n            pubdate: summary.pubdate || \"\",\n            cover: summary.cover || \"\",\n            summary: ((_item$onix = item.onix) === null || _item$onix === void 0 ? void 0 : (_item$onix$Collateral = _item$onix.CollateralDetail) === null || _item$onix$Collateral === void 0 ? void 0 : (_item$onix$Collateral2 = _item$onix$Collateral.TextContent) === null || _item$onix$Collateral2 === void 0 ? void 0 : (_item$onix$Collateral3 = _item$onix$Collateral2.find(text => text.TextType === \"03\" // 03„ÅØÂÜÖÂÆπÁ¥π‰ªã\n            )) === null || _item$onix$Collateral3 === void 0 ? void 0 : _item$onix$Collateral3.Text) || \"\"\n          };\n        });\n        console.log(\"‚úÖ Êõ∏Á±ç„Éá„Éº„ÇøÂèñÂæóÊàêÂäü:\", bookList.length, \"‰ª∂\");\n        setBooks(bookList);\n      } catch (err) {\n        console.error(\"‚ùå Êõ∏Á±ç„Éá„Éº„Çø„ÅÆÂèñÂæó„Å´Â§±Êïó„Åó„Åæ„Åó„Åü:\", err);\n        setError(err instanceof Error ? err.message : \"‰∏çÊòé„Å™„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü\");\n        setBooks([]);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    fetchBooks();\n  }, []);\n  return {\n    books,\n    isLoading,\n    error\n  };\n}\n_s(useRecentBooks, \"IQ++4uVhX3pSOrUcIUrjuYAPPSo=\");","map":{"version":3,"names":["useState","useEffect","recentBookISBNs","useRecentBooks","_s","books","setBooks","isLoading","setIsLoading","error","setError","fetchBooks","length","isbnQuery","join","console","log","response","fetch","ok","Error","statusText","data","json","validData","filter","item","warn","bookList","map","_item$onix","_item$onix$Collateral","_item$onix$Collateral2","_item$onix$Collateral3","summary","isbn","title","author","publisher","pubdate","cover","onix","CollateralDetail","TextContent","find","text","TextType","Text","err","message"],"sources":["/Users/shiwa/Desktop/wanttodev.com/src/hooks/useRecentBooks.ts"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { recentBookISBNs } from \"../data/recentBooks\";\n\n// openBD API„ÅÆ„É¨„Çπ„Éù„É≥„ÇπÂûãÂÆöÁæ©\nexport interface BookInfo {\n  isbn: string;\n  title: string;\n  author: string;\n  publisher: string;\n  pubdate: string;\n  cover: string;\n  summary: string;\n}\n\ninterface OpenBDResponse {\n  onix: {\n    DescriptiveDetail: {\n      TitleDetail: {\n        TitleElement: {\n          TitleText: {\n            content: string;\n          };\n        };\n      };\n      Contributor: Array<{\n        PersonName: {\n          content: string;\n        };\n        ContributorRole: Array<{\n          value: string;\n        }>;\n      }>;\n    };\n    PublishingDetail: {\n      Publisher: {\n        PublisherName: {\n          content: string;\n        };\n      };\n      PublishingDate: {\n        Date: string;\n      };\n    };\n    CollateralDetail: {\n      TextContent: Array<{\n        Text: string;\n        TextType: string;\n      }>;\n    };\n  };\n  summary: {\n    cover: string;\n    title: string;\n    author: string;\n    publisher: string;\n    pubdate: string;\n    isbn: string;\n  };\n}\n\nexport function useRecentBooks() {\n  const [books, setBooks] = useState<BookInfo[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    const fetchBooks = async () => {\n      if (recentBookISBNs.length === 0) {\n        setIsLoading(false);\n        return;\n      }\n\n      try {\n        setIsLoading(true);\n        setError(null);\n\n        // openBD API„ÇíÂëº„Å≥Âá∫„ÅóÔºàISBN„Çí„Ç´„É≥„ÉûÂå∫Âàá„Çä„ÅßÊåáÂÆöÔºâ\n        const isbnQuery = recentBookISBNs.join(\",\");\n        console.log(\"üìö Êõ∏Á±ç„Éá„Éº„ÇøÂèñÂæóÈñãÂßã - ISBN:\", isbnQuery);\n        \n        const response = await fetch(\n          `https://api.openbd.jp/v1/get?isbn=${isbnQuery}`\n        );\n\n        if (!response.ok) {\n          throw new Error(`API„É™„ÇØ„Ç®„Çπ„Éà„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ${response.statusText}`);\n        }\n\n        const data: (OpenBDResponse | null)[] = await response.json();\n        console.log(\"üìö API„É¨„Çπ„Éù„É≥„Çπ:\", data);\n\n        // null„ÉÅ„Çß„ÉÉ„ÇØ„Å®„Éá„Éº„Çø„ÅÆÊï¥ÂΩ¢\n        const validData = data.filter((item): item is OpenBDResponse => item !== null);\n        \n        if (validData.length === 0) {\n          console.warn(\"‚ö†Ô∏è ÂèñÂæó„Åó„Åü„Éá„Éº„Çø„Åå„Åô„Åπ„Å¶null„Åß„Åô„ÄÇISBN„Ç≥„Éº„Éâ„ÅåÊ≠£„Åó„ÅÑ„Åã„ÄÅopenBD„Å´„Éá„Éº„Çø„ÅåÂ≠òÂú®„Åô„Çã„ÅãÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ\");\n          setError(`ISBN„Ç≥„Éº„Éâ ${isbnQuery} „ÅÆÊõ∏Á±çÊÉÖÂ†±„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ`);\n          setBooks([]);\n          return;\n        }\n\n        // „Éá„Éº„Çø„ÇíÊï¥ÂΩ¢\n        const bookList: BookInfo[] = validData.map((item) => {\n          const summary = item.summary;\n          console.log(\"üìñ Êõ∏Á±çÊÉÖÂ†±:\", summary);\n          return {\n            isbn: summary.isbn || \"\",\n            title: summary.title || \"\",\n            author: summary.author || \"\",\n            publisher: summary.publisher || \"\",\n            pubdate: summary.pubdate || \"\",\n            cover: summary.cover || \"\",\n            summary:\n              item.onix?.CollateralDetail?.TextContent?.find(\n                (text) => text.TextType === \"03\" // 03„ÅØÂÜÖÂÆπÁ¥π‰ªã\n              )?.Text || \"\",\n          };\n        });\n\n        console.log(\"‚úÖ Êõ∏Á±ç„Éá„Éº„ÇøÂèñÂæóÊàêÂäü:\", bookList.length, \"‰ª∂\");\n        setBooks(bookList);\n      } catch (err) {\n        console.error(\"‚ùå Êõ∏Á±ç„Éá„Éº„Çø„ÅÆÂèñÂæó„Å´Â§±Êïó„Åó„Åæ„Åó„Åü:\", err);\n        setError(\n          err instanceof Error ? err.message : \"‰∏çÊòé„Å™„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü\"\n        );\n        setBooks([]);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchBooks();\n  }, []);\n\n  return { books, isLoading, error };\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}