{"ast":null,"code":"import{useState,useEffect}from\"react\";// 共通の認証チェック関数\nconst checkAuth=authKey=>{try{const authStatus=localStorage.getItem(authKey);const authTimestamp=localStorage.getItem(\"\".concat(authKey,\"_timestamp\"));if(authStatus===\"true\"&&authTimestamp){// 認証の有効期限をチェック（24時間）\nconst now=Date.now();const authTime=parseInt(authTimestamp,10);const twentyFourHours=24*60*60*1000;// 24時間をミリ秒で表現\nif(now-authTime<twentyFourHours){return true;}else{// 認証期限切れの場合は認証情報を削除\nlocalStorage.removeItem(authKey);localStorage.removeItem(\"\".concat(authKey,\"_timestamp\"));return false;}}return false;}catch(error){console.error(\"認証状態の確認中にエラーが発生しました:\",error);return false;}};// Works用の認証フック\nexport function useAuth(){const[authState,setAuthState]=useState({isAuthenticated:false,isLoading:true});// 認証成功時の処理（BasicAuthコンポーネントから呼び出される）\nconst login=()=>{// 認証状態を再チェックしてから設定\nconst isAuth=checkAuth(\"works_auth\");setAuthState({isAuthenticated:isAuth,isLoading:false});};// ログアウト処理\nconst logout=()=>{localStorage.removeItem(\"works_auth\");localStorage.removeItem(\"works_auth_timestamp\");setAuthState({isAuthenticated:false,isLoading:false});};// コンポーネントマウント時に認証状態をチェック\nuseEffect(()=>{const isAuth=checkAuth(\"works_auth\");setAuthState({isAuthenticated:isAuth,isLoading:false});},[]);return{isAuthenticated:authState.isAuthenticated,isLoading:authState.isLoading,login,logout};}","map":{"version":3,"names":["useState","useEffect","checkAuth","authKey","authStatus","localStorage","getItem","authTimestamp","concat","now","Date","authTime","parseInt","twentyFourHours","removeItem","error","console","useAuth","authState","setAuthState","isAuthenticated","isLoading","login","isAuth","logout"],"sources":["/Users/shiwa/Desktop/wanttodev.com/src/hooks/useAuth.ts"],"sourcesContent":["import { useState, useEffect } from \"react\";\n\ninterface AuthState {\n  isAuthenticated: boolean;\n  isLoading: boolean;\n}\n\n// 共通の認証チェック関数\nconst checkAuth = (authKey: string) => {\n  try {\n    const authStatus = localStorage.getItem(authKey);\n    const authTimestamp = localStorage.getItem(`${authKey}_timestamp`);\n\n    if (authStatus === \"true\" && authTimestamp) {\n      // 認証の有効期限をチェック（24時間）\n      const now = Date.now();\n      const authTime = parseInt(authTimestamp, 10);\n      const twentyFourHours = 24 * 60 * 60 * 1000; // 24時間をミリ秒で表現\n\n      if (now - authTime < twentyFourHours) {\n        return true;\n      } else {\n        // 認証期限切れの場合は認証情報を削除\n        localStorage.removeItem(authKey);\n        localStorage.removeItem(`${authKey}_timestamp`);\n        return false;\n      }\n    }\n    return false;\n  } catch (error) {\n    console.error(\"認証状態の確認中にエラーが発生しました:\", error);\n    return false;\n  }\n};\n\n// Works用の認証フック\nexport function useAuth() {\n  const [authState, setAuthState] = useState<AuthState>({\n    isAuthenticated: false,\n    isLoading: true,\n  });\n\n  // 認証成功時の処理（BasicAuthコンポーネントから呼び出される）\n  const login = () => {\n    // 認証状態を再チェックしてから設定\n    const isAuth = checkAuth(\"works_auth\");\n    setAuthState({\n      isAuthenticated: isAuth,\n      isLoading: false,\n    });\n  };\n\n  // ログアウト処理\n  const logout = () => {\n    localStorage.removeItem(\"works_auth\");\n    localStorage.removeItem(\"works_auth_timestamp\");\n    setAuthState({\n      isAuthenticated: false,\n      isLoading: false,\n    });\n  };\n\n  // コンポーネントマウント時に認証状態をチェック\n  useEffect(() => {\n    const isAuth = checkAuth(\"works_auth\");\n    setAuthState({\n      isAuthenticated: isAuth,\n      isLoading: false,\n    });\n  }, []);\n\n  return {\n    isAuthenticated: authState.isAuthenticated,\n    isLoading: authState.isLoading,\n    login,\n    logout,\n  };\n}\n"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAO3C;AACA,KAAM,CAAAC,SAAS,CAAIC,OAAe,EAAK,CACrC,GAAI,CACF,KAAM,CAAAC,UAAU,CAAGC,YAAY,CAACC,OAAO,CAACH,OAAO,CAAC,CAChD,KAAM,CAAAI,aAAa,CAAGF,YAAY,CAACC,OAAO,IAAAE,MAAA,CAAIL,OAAO,cAAY,CAAC,CAElE,GAAIC,UAAU,GAAK,MAAM,EAAIG,aAAa,CAAE,CAC1C;AACA,KAAM,CAAAE,GAAG,CAAGC,IAAI,CAACD,GAAG,CAAC,CAAC,CACtB,KAAM,CAAAE,QAAQ,CAAGC,QAAQ,CAACL,aAAa,CAAE,EAAE,CAAC,CAC5C,KAAM,CAAAM,eAAe,CAAG,EAAE,CAAG,EAAE,CAAG,EAAE,CAAG,IAAI,CAAE;AAE7C,GAAIJ,GAAG,CAAGE,QAAQ,CAAGE,eAAe,CAAE,CACpC,MAAO,KAAI,CACb,CAAC,IAAM,CACL;AACAR,YAAY,CAACS,UAAU,CAACX,OAAO,CAAC,CAChCE,YAAY,CAACS,UAAU,IAAAN,MAAA,CAAIL,OAAO,cAAY,CAAC,CAC/C,MAAO,MAAK,CACd,CACF,CACA,MAAO,MAAK,CACd,CAAE,MAAOY,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAAC,CAC5C,MAAO,MAAK,CACd,CACF,CAAC,CAED;AACA,MAAO,SAAS,CAAAE,OAAOA,CAAA,CAAG,CACxB,KAAM,CAACC,SAAS,CAAEC,YAAY,CAAC,CAAGnB,QAAQ,CAAY,CACpDoB,eAAe,CAAE,KAAK,CACtBC,SAAS,CAAE,IACb,CAAC,CAAC,CAEF;AACA,KAAM,CAAAC,KAAK,CAAGA,CAAA,GAAM,CAClB;AACA,KAAM,CAAAC,MAAM,CAAGrB,SAAS,CAAC,YAAY,CAAC,CACtCiB,YAAY,CAAC,CACXC,eAAe,CAAEG,MAAM,CACvBF,SAAS,CAAE,KACb,CAAC,CAAC,CACJ,CAAC,CAED;AACA,KAAM,CAAAG,MAAM,CAAGA,CAAA,GAAM,CACnBnB,YAAY,CAACS,UAAU,CAAC,YAAY,CAAC,CACrCT,YAAY,CAACS,UAAU,CAAC,sBAAsB,CAAC,CAC/CK,YAAY,CAAC,CACXC,eAAe,CAAE,KAAK,CACtBC,SAAS,CAAE,KACb,CAAC,CAAC,CACJ,CAAC,CAED;AACApB,SAAS,CAAC,IAAM,CACd,KAAM,CAAAsB,MAAM,CAAGrB,SAAS,CAAC,YAAY,CAAC,CACtCiB,YAAY,CAAC,CACXC,eAAe,CAAEG,MAAM,CACvBF,SAAS,CAAE,KACb,CAAC,CAAC,CACJ,CAAC,CAAE,EAAE,CAAC,CAEN,MAAO,CACLD,eAAe,CAAEF,SAAS,CAACE,eAAe,CAC1CC,SAAS,CAAEH,SAAS,CAACG,SAAS,CAC9BC,KAAK,CACLE,MACF,CAAC,CACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}