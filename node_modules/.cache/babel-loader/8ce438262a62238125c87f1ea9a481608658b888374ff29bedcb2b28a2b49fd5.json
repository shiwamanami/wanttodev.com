{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport { recentBookISBNs } from \"../data/recentBooks\";\n\n// openBD APIのレスポンス型定義\n\nexport function useRecentBooks() {\n  _s();\n  const [books, setBooks] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    const fetchBooks = async () => {\n      if (recentBookISBNs.length === 0) {\n        setIsLoading(false);\n        return;\n      }\n      try {\n        setIsLoading(true);\n        setError(null);\n\n        // openBD APIを呼び出し（ISBNをカンマ区切りで指定）\n        const isbnQuery = recentBookISBNs.join(\",\");\n        const response = await fetch(`https://api.openbd.jp/v1/get?isbn=${isbnQuery}`);\n        if (!response.ok) {\n          throw new Error(`APIリクエストに失敗しました: ${response.statusText}`);\n        }\n        const data = await response.json();\n\n        // データを整形\n        const bookList = data.filter(item => item !== null).map(item => {\n          var _item$onix, _item$onix$Collateral, _item$onix$Collateral2, _item$onix$Collateral3;\n          const summary = item.summary;\n          return {\n            isbn: summary.isbn || \"\",\n            title: summary.title || \"\",\n            author: summary.author || \"\",\n            publisher: summary.publisher || \"\",\n            pubdate: summary.pubdate || \"\",\n            cover: summary.cover || \"\",\n            summary: ((_item$onix = item.onix) === null || _item$onix === void 0 ? void 0 : (_item$onix$Collateral = _item$onix.CollateralDetail) === null || _item$onix$Collateral === void 0 ? void 0 : (_item$onix$Collateral2 = _item$onix$Collateral.TextContent) === null || _item$onix$Collateral2 === void 0 ? void 0 : (_item$onix$Collateral3 = _item$onix$Collateral2.find(text => text.TextType === \"03\" // 03は内容紹介\n            )) === null || _item$onix$Collateral3 === void 0 ? void 0 : _item$onix$Collateral3.Text) || \"\"\n          };\n        });\n        setBooks(bookList);\n      } catch (err) {\n        console.error(\"書籍データの取得に失敗しました:\", err);\n        setError(err instanceof Error ? err.message : \"不明なエラーが発生しました\");\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    fetchBooks();\n  }, []);\n  return {\n    books,\n    isLoading,\n    error\n  };\n}\n_s(useRecentBooks, \"IQ++4uVhX3pSOrUcIUrjuYAPPSo=\");","map":{"version":3,"names":["useState","useEffect","recentBookISBNs","useRecentBooks","_s","books","setBooks","isLoading","setIsLoading","error","setError","fetchBooks","length","isbnQuery","join","response","fetch","ok","Error","statusText","data","json","bookList","filter","item","map","_item$onix","_item$onix$Collateral","_item$onix$Collateral2","_item$onix$Collateral3","summary","isbn","title","author","publisher","pubdate","cover","onix","CollateralDetail","TextContent","find","text","TextType","Text","err","console","message"],"sources":["/Users/shiwa/Desktop/wanttodev.com/src/hooks/useRecentBooks.ts"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { recentBookISBNs } from \"../data/recentBooks\";\n\n// openBD APIのレスポンス型定義\nexport interface BookInfo {\n  isbn: string;\n  title: string;\n  author: string;\n  publisher: string;\n  pubdate: string;\n  cover: string;\n  summary: string;\n}\n\ninterface OpenBDResponse {\n  onix: {\n    DescriptiveDetail: {\n      TitleDetail: {\n        TitleElement: {\n          TitleText: {\n            content: string;\n          };\n        };\n      };\n      Contributor: Array<{\n        PersonName: {\n          content: string;\n        };\n        ContributorRole: Array<{\n          value: string;\n        }>;\n      }>;\n    };\n    PublishingDetail: {\n      Publisher: {\n        PublisherName: {\n          content: string;\n        };\n      };\n      PublishingDate: {\n        Date: string;\n      };\n    };\n    CollateralDetail: {\n      TextContent: Array<{\n        Text: string;\n        TextType: string;\n      }>;\n    };\n  };\n  summary: {\n    cover: string;\n    title: string;\n    author: string;\n    publisher: string;\n    pubdate: string;\n    isbn: string;\n  };\n}\n\nexport function useRecentBooks() {\n  const [books, setBooks] = useState<BookInfo[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    const fetchBooks = async () => {\n      if (recentBookISBNs.length === 0) {\n        setIsLoading(false);\n        return;\n      }\n\n      try {\n        setIsLoading(true);\n        setError(null);\n\n        // openBD APIを呼び出し（ISBNをカンマ区切りで指定）\n        const isbnQuery = recentBookISBNs.join(\",\");\n        const response = await fetch(\n          `https://api.openbd.jp/v1/get?isbn=${isbnQuery}`\n        );\n\n        if (!response.ok) {\n          throw new Error(`APIリクエストに失敗しました: ${response.statusText}`);\n        }\n\n        const data: (OpenBDResponse | null)[] = await response.json();\n\n        // データを整形\n        const bookList: BookInfo[] = data\n          .filter((item): item is OpenBDResponse => item !== null)\n          .map((item) => {\n            const summary = item.summary;\n            return {\n              isbn: summary.isbn || \"\",\n              title: summary.title || \"\",\n              author: summary.author || \"\",\n              publisher: summary.publisher || \"\",\n              pubdate: summary.pubdate || \"\",\n              cover: summary.cover || \"\",\n              summary:\n                item.onix?.CollateralDetail?.TextContent?.find(\n                  (text) => text.TextType === \"03\" // 03は内容紹介\n                )?.Text || \"\",\n            };\n          });\n\n        setBooks(bookList);\n      } catch (err) {\n        console.error(\"書籍データの取得に失敗しました:\", err);\n        setError(\n          err instanceof Error ? err.message : \"不明なエラーが発生しました\"\n        );\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchBooks();\n  }, []);\n\n  return { books, isLoading, error };\n}\n\n"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,SAASC,eAAe,QAAQ,qBAAqB;;AAErD;;AAyDA,OAAO,SAASC,cAAcA,CAAA,EAAG;EAAAC,EAAA;EAC/B,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGN,QAAQ,CAAa,EAAE,CAAC;EAClD,MAAM,CAACO,SAAS,EAAEC,YAAY,CAAC,GAAGR,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAACS,KAAK,EAAEC,QAAQ,CAAC,GAAGV,QAAQ,CAAgB,IAAI,CAAC;EAEvDC,SAAS,CAAC,MAAM;IACd,MAAMU,UAAU,GAAG,MAAAA,CAAA,KAAY;MAC7B,IAAIT,eAAe,CAACU,MAAM,KAAK,CAAC,EAAE;QAChCJ,YAAY,CAAC,KAAK,CAAC;QACnB;MACF;MAEA,IAAI;QACFA,YAAY,CAAC,IAAI,CAAC;QAClBE,QAAQ,CAAC,IAAI,CAAC;;QAEd;QACA,MAAMG,SAAS,GAAGX,eAAe,CAACY,IAAI,CAAC,GAAG,CAAC;QAC3C,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAC1B,qCAAqCH,SAAS,EAChD,CAAC;QAED,IAAI,CAACE,QAAQ,CAACE,EAAE,EAAE;UAChB,MAAM,IAAIC,KAAK,CAAC,oBAAoBH,QAAQ,CAACI,UAAU,EAAE,CAAC;QAC5D;QAEA,MAAMC,IAA+B,GAAG,MAAML,QAAQ,CAACM,IAAI,CAAC,CAAC;;QAE7D;QACA,MAAMC,QAAoB,GAAGF,IAAI,CAC9BG,MAAM,CAAEC,IAAI,IAA6BA,IAAI,KAAK,IAAI,CAAC,CACvDC,GAAG,CAAED,IAAI,IAAK;UAAA,IAAAE,UAAA,EAAAC,qBAAA,EAAAC,sBAAA,EAAAC,sBAAA;UACb,MAAMC,OAAO,GAAGN,IAAI,CAACM,OAAO;UAC5B,OAAO;YACLC,IAAI,EAAED,OAAO,CAACC,IAAI,IAAI,EAAE;YACxBC,KAAK,EAAEF,OAAO,CAACE,KAAK,IAAI,EAAE;YAC1BC,MAAM,EAAEH,OAAO,CAACG,MAAM,IAAI,EAAE;YAC5BC,SAAS,EAAEJ,OAAO,CAACI,SAAS,IAAI,EAAE;YAClCC,OAAO,EAAEL,OAAO,CAACK,OAAO,IAAI,EAAE;YAC9BC,KAAK,EAAEN,OAAO,CAACM,KAAK,IAAI,EAAE;YAC1BN,OAAO,EACL,EAAAJ,UAAA,GAAAF,IAAI,CAACa,IAAI,cAAAX,UAAA,wBAAAC,qBAAA,GAATD,UAAA,CAAWY,gBAAgB,cAAAX,qBAAA,wBAAAC,sBAAA,GAA3BD,qBAAA,CAA6BY,WAAW,cAAAX,sBAAA,wBAAAC,sBAAA,GAAxCD,sBAAA,CAA0CY,IAAI,CAC3CC,IAAI,IAAKA,IAAI,CAACC,QAAQ,KAAK,IAAI,CAAC;YACnC,CAAC,cAAAb,sBAAA,uBAFDA,sBAAA,CAEGc,IAAI,KAAI;UACf,CAAC;QACH,CAAC,CAAC;QAEJrC,QAAQ,CAACgB,QAAQ,CAAC;MACpB,CAAC,CAAC,OAAOsB,GAAG,EAAE;QACZC,OAAO,CAACpC,KAAK,CAAC,kBAAkB,EAAEmC,GAAG,CAAC;QACtClC,QAAQ,CACNkC,GAAG,YAAY1B,KAAK,GAAG0B,GAAG,CAACE,OAAO,GAAG,eACvC,CAAC;MACH,CAAC,SAAS;QACRtC,YAAY,CAAC,KAAK,CAAC;MACrB;IACF,CAAC;IAEDG,UAAU,CAAC,CAAC;EACd,CAAC,EAAE,EAAE,CAAC;EAEN,OAAO;IAAEN,KAAK;IAAEE,SAAS;IAAEE;EAAM,CAAC;AACpC;AAACL,EAAA,CA9DeD,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}