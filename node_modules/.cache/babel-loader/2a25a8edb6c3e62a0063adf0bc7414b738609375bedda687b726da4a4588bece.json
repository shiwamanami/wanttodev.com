{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport { validateWorksData, worksData } from \"../data/works\";\nimport { readJsonFile, autoUpdateJsonFile, realtimeUpdateJsonFile, readFromLocalStorage, saveToLocalStorage } from \"../lib/fileUtils\";\nconst DYNAMIC_DATA_PATH = \"/works-dynamic.json\";\nconst STORAGE_KEY = \"works-data-backup\"; // „Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„ÉóÁî®„Å´Â§âÊõ¥\n\nexport function useWorksData() {\n  _s();\n  const [works, setWorks] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  // „Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø\n  useEffect(() => {\n    const loadData = async () => {\n      try {\n        // „Åæ„ÅöÂãïÁöÑ„Éá„Éº„Çø„Éï„Ç°„Ç§„É´„ÇíË™≠„ÅøËæº„ÇÄ\n        const fileResult = await readJsonFile(DYNAMIC_DATA_PATH);\n        if (fileResult.success && Array.isArray(fileResult.data)) {\n          // „Éï„Ç°„Ç§„É´„Åã„ÇâË™≠„ÅøËæº„Çì„Å†„Éá„Éº„Çø„Çí„Éê„É™„Éá„Éº„Ç∑„Éß„É≥\n          const validData = fileResult.data.filter(validateWorksData);\n          if (validData.length > 0) {\n            console.log(\"üìÅ „Éï„Ç°„Ç§„É´„Åã„Çâ„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø„Åæ„Åó„Åü:\", validData.length, \"‰ª∂\");\n            setWorks(validData);\n            setIsLoading(false);\n            return;\n          }\n        }\n        console.log(\"‚ö†Ô∏è „Éï„Ç°„Ç§„É´„ÅåÁ©∫„Åæ„Åü„ÅØÁÑ°Âäπ„Åß„Åô„ÄÇ„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Éá„Éº„Çø„Çí„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Åæ„Åô...\");\n\n        // „Éï„Ç°„Ç§„É´„ÅåÁ©∫„Åæ„Åü„ÅØÁÑ°Âäπ„Å™Â†¥Âêà„ÅØ„ÄÅ„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Éá„Éº„Çø„Çí„ÉÅ„Çß„ÉÉ„ÇØ\n        const backupData = readFromLocalStorage(STORAGE_KEY);\n        if (backupData.length > 0) {\n          console.log(\"üíæ „Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Éá„Éº„Çø„Åã„ÇâÂæ©ÂÖÉ„Åó„Åæ„Åô:\", backupData.length, \"‰ª∂\");\n          const validData = backupData.filter(validateWorksData);\n          setWorks(validData);\n          // „Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Éá„Éº„Çø„Çí„Éï„Ç°„Ç§„É´„Å´Âæ©ÂÖÉ\n          await autoUpdateJsonFile(DYNAMIC_DATA_PATH, validData);\n        } else {\n          console.log(\"üìã ÂàùÊúü„Éá„Éº„Çø„Çí‰ΩøÁî®„Åó„Åæ„Åô\");\n          // „Å©„Å°„Çâ„ÇÇ„Å™„ÅÑÂ†¥Âêà„ÅØÂàùÊúü„Éá„Éº„Çø„Çí‰ΩøÁî®\n          setWorks(worksData);\n        }\n      } catch (error) {\n        console.error(\"‚ùå „Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü:\", error);\n        // „Ç®„É©„Éº„ÅÆÂ†¥Âêà„ÅØÂàùÊúü„Éá„Éº„Çø„Çí‰ΩøÁî®\n        setWorks(worksData);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    loadData();\n  }, []);\n\n  // „Éá„Éº„Çø„Çí‰øùÂ≠ò\n  const saveWorks = async newWorks => {\n    try {\n      // UI„ÇíÂç≥Â∫ß„Å´Êõ¥Êñ∞\n      setWorks(newWorks);\n\n      // „É™„Ç¢„É´„Çø„Ç§„É†„Éï„Ç°„Ç§„É´Êõ¥Êñ∞Ê©üËÉΩ„Çí‰ΩøÁî®\n      const fileResult = await realtimeUpdateJsonFile(DYNAMIC_DATA_PATH, newWorks);\n      if (fileResult.success) {\n        console.log(\"‚úÖ „Éá„Éº„Çø„ÅåÊõ¥Êñ∞„Åï„Çå„Åæ„Åó„Åü\");\n        console.log(\"üìÅ src/data/works-dynamic.json „ÅåËá™ÂãïÊõ¥Êñ∞„Åï„Çå„Åæ„Åó„Åü\");\n      } else {\n        console.warn(\"‚ö†Ô∏è „Éï„Ç°„Ç§„É´„Å∏„ÅÆ‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü:\", fileResult.error);\n        // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ„Å®„Åó„Å¶„É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Å´‰øùÂ≠ò\n        saveToLocalStorage(STORAGE_KEY, newWorks);\n        console.log(\"üíæ „Éá„Éº„Çø„ÅØ„É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Å´„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Åï„Çå„Åæ„Åó„Åü\");\n      }\n    } catch (error) {\n      console.error(\"‚ùå „Éá„Éº„Çø„ÅÆ‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü:\", error);\n      // „Ç®„É©„ÉºÊôÇ„ÅØ„É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Å´‰øùÂ≠ò\n      saveToLocalStorage(STORAGE_KEY, newWorks);\n      console.log(\"üíæ „Éá„Éº„Çø„ÅØ„É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Å´„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Åï„Çå„Åæ„Åó„Åü\");\n    }\n  };\n\n  // ‰ΩúÂìÅ„ÇíËøΩÂä†\n  const addWork = async work => {\n    const newWorks = [...works, work];\n    await saveWorks(newWorks);\n  };\n\n  // ‰ΩúÂìÅ„ÇíÊõ¥Êñ∞\n  const updateWork = async (id, updatedWork) => {\n    const newWorks = works.map(work => work.id === id ? {\n      ...updatedWork,\n      id,\n      updatedAt: new Date().toISOString()\n    } : work);\n    await saveWorks(newWorks);\n  };\n\n  // ‰ΩúÂìÅ„ÇíÂâäÈô§\n  const deleteWork = async id => {\n    const newWorks = works.filter(work => work.id !== id);\n    await saveWorks(newWorks);\n  };\n\n  // ‰ΩúÂìÅ„ÇíÂèñÂæó\n  const getWork = id => {\n    return works.find(work => work.id === id);\n  };\n  return {\n    works,\n    isLoading,\n    addWork,\n    updateWork,\n    deleteWork,\n    getWork,\n    saveWorks\n  };\n}\n_s(useWorksData, \"ur/+y9NuI/6fT246hxzmfgv9QtU=\");","map":{"version":3,"names":["useState","useEffect","validateWorksData","worksData","readJsonFile","autoUpdateJsonFile","realtimeUpdateJsonFile","readFromLocalStorage","saveToLocalStorage","DYNAMIC_DATA_PATH","STORAGE_KEY","useWorksData","_s","works","setWorks","isLoading","setIsLoading","loadData","fileResult","success","Array","isArray","data","validData","filter","length","console","log","backupData","error","saveWorks","newWorks","warn","addWork","work","updateWork","id","updatedWork","map","updatedAt","Date","toISOString","deleteWork","getWork","find"],"sources":["/Users/shiwa/Desktop/wanttodev.com/src/hooks/useWorksData.ts"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { Works, validateWorksData, worksData } from \"../data/works\";\nimport {\n  readJsonFile,\n  autoUpdateJsonFile,\n  realtimeUpdateJsonFile,\n  readFromLocalStorage,\n  saveToLocalStorage,\n} from \"../lib/fileUtils\";\n\nconst DYNAMIC_DATA_PATH = \"/works-dynamic.json\";\nconst STORAGE_KEY = \"works-data-backup\"; // „Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„ÉóÁî®„Å´Â§âÊõ¥\n\nexport function useWorksData() {\n  const [works, setWorks] = useState<Works[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  // „Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø\n  useEffect(() => {\n    const loadData = async () => {\n      try {\n        // „Åæ„ÅöÂãïÁöÑ„Éá„Éº„Çø„Éï„Ç°„Ç§„É´„ÇíË™≠„ÅøËæº„ÇÄ\n        const fileResult = await readJsonFile(DYNAMIC_DATA_PATH);\n\n        if (fileResult.success && Array.isArray(fileResult.data)) {\n          // „Éï„Ç°„Ç§„É´„Åã„ÇâË™≠„ÅøËæº„Çì„Å†„Éá„Éº„Çø„Çí„Éê„É™„Éá„Éº„Ç∑„Éß„É≥\n          const validData = fileResult.data.filter(validateWorksData);\n          if (validData.length > 0) {\n            console.log(\n              \"üìÅ „Éï„Ç°„Ç§„É´„Åã„Çâ„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø„Åæ„Åó„Åü:\",\n              validData.length,\n              \"‰ª∂\"\n            );\n            setWorks(validData);\n            setIsLoading(false);\n            return;\n          }\n        }\n\n        console.log(\n          \"‚ö†Ô∏è „Éï„Ç°„Ç§„É´„ÅåÁ©∫„Åæ„Åü„ÅØÁÑ°Âäπ„Åß„Åô„ÄÇ„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Éá„Éº„Çø„Çí„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Åæ„Åô...\"\n        );\n\n        // „Éï„Ç°„Ç§„É´„ÅåÁ©∫„Åæ„Åü„ÅØÁÑ°Âäπ„Å™Â†¥Âêà„ÅØ„ÄÅ„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Éá„Éº„Çø„Çí„ÉÅ„Çß„ÉÉ„ÇØ\n        const backupData = readFromLocalStorage(STORAGE_KEY);\n        if (backupData.length > 0) {\n          console.log(\n            \"üíæ „Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Éá„Éº„Çø„Åã„ÇâÂæ©ÂÖÉ„Åó„Åæ„Åô:\",\n            backupData.length,\n            \"‰ª∂\"\n          );\n          const validData = backupData.filter(validateWorksData);\n          setWorks(validData);\n          // „Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Éá„Éº„Çø„Çí„Éï„Ç°„Ç§„É´„Å´Âæ©ÂÖÉ\n          await autoUpdateJsonFile(DYNAMIC_DATA_PATH, validData);\n        } else {\n          console.log(\"üìã ÂàùÊúü„Éá„Éº„Çø„Çí‰ΩøÁî®„Åó„Åæ„Åô\");\n          // „Å©„Å°„Çâ„ÇÇ„Å™„ÅÑÂ†¥Âêà„ÅØÂàùÊúü„Éá„Éº„Çø„Çí‰ΩøÁî®\n          setWorks(worksData);\n        }\n      } catch (error) {\n        console.error(\"‚ùå „Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü:\", error);\n        // „Ç®„É©„Éº„ÅÆÂ†¥Âêà„ÅØÂàùÊúü„Éá„Éº„Çø„Çí‰ΩøÁî®\n        setWorks(worksData);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    loadData();\n  }, []);\n\n  // „Éá„Éº„Çø„Çí‰øùÂ≠ò\n  const saveWorks = async (newWorks: Works[]) => {\n    try {\n      // UI„ÇíÂç≥Â∫ß„Å´Êõ¥Êñ∞\n      setWorks(newWorks);\n\n      // „É™„Ç¢„É´„Çø„Ç§„É†„Éï„Ç°„Ç§„É´Êõ¥Êñ∞Ê©üËÉΩ„Çí‰ΩøÁî®\n      const fileResult = await realtimeUpdateJsonFile(\n        DYNAMIC_DATA_PATH,\n        newWorks\n      );\n      if (fileResult.success) {\n        console.log(\"‚úÖ „Éá„Éº„Çø„ÅåÊõ¥Êñ∞„Åï„Çå„Åæ„Åó„Åü\");\n        console.log(\"üìÅ src/data/works-dynamic.json „ÅåËá™ÂãïÊõ¥Êñ∞„Åï„Çå„Åæ„Åó„Åü\");\n      } else {\n        console.warn(\"‚ö†Ô∏è „Éï„Ç°„Ç§„É´„Å∏„ÅÆ‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü:\", fileResult.error);\n        // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ„Å®„Åó„Å¶„É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Å´‰øùÂ≠ò\n        saveToLocalStorage(STORAGE_KEY, newWorks);\n        console.log(\"üíæ „Éá„Éº„Çø„ÅØ„É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Å´„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Åï„Çå„Åæ„Åó„Åü\");\n      }\n    } catch (error) {\n      console.error(\"‚ùå „Éá„Éº„Çø„ÅÆ‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü:\", error);\n      // „Ç®„É©„ÉºÊôÇ„ÅØ„É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Å´‰øùÂ≠ò\n      saveToLocalStorage(STORAGE_KEY, newWorks);\n      console.log(\"üíæ „Éá„Éº„Çø„ÅØ„É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Å´„Éê„ÉÉ„ÇØ„Ç¢„ÉÉ„Éó„Åï„Çå„Åæ„Åó„Åü\");\n    }\n  };\n\n  // ‰ΩúÂìÅ„ÇíËøΩÂä†\n  const addWork = async (work: Works) => {\n    const newWorks = [...works, work];\n    await saveWorks(newWorks);\n  };\n\n  // ‰ΩúÂìÅ„ÇíÊõ¥Êñ∞\n  const updateWork = async (id: number, updatedWork: Works) => {\n    const newWorks = works.map((work) =>\n      work.id === id\n        ? { ...updatedWork, id, updatedAt: new Date().toISOString() }\n        : work\n    );\n    await saveWorks(newWorks);\n  };\n\n  // ‰ΩúÂìÅ„ÇíÂâäÈô§\n  const deleteWork = async (id: number) => {\n    const newWorks = works.filter((work) => work.id !== id);\n    await saveWorks(newWorks);\n  };\n\n  // ‰ΩúÂìÅ„ÇíÂèñÂæó\n  const getWork = (id: number) => {\n    return works.find((work) => work.id === id);\n  };\n\n  return {\n    works,\n    isLoading,\n    addWork,\n    updateWork,\n    deleteWork,\n    getWork,\n    saveWorks,\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}