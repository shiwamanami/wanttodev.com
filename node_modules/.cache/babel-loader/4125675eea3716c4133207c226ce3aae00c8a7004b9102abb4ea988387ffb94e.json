{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport { recentBookISBNs } from \"../data/recentBooks\";\n\n// Google Books APIのレスポンス型定義\n\n// コンポーネントで使用する書籍情報の型\n\nexport function useRecentBooks() {\n  _s();\n  const [books, setBooks] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    const fetchBooks = async () => {\n      if (recentBookISBNs.length === 0) {\n        setIsLoading(false);\n        return;\n      }\n      try {\n        setIsLoading(true);\n        setError(null);\n\n        // Google Books APIを呼び出し（各ISBNを個別に取得）\n        const bookPromises = recentBookISBNs.map(async isbn => {\n          try {\n            var _volumeInfo$imageLink, _volumeInfo$imageLink2, _volumeInfo$imageLink3, _volumeInfo$imageLink4, _volumeInfo$industryI, _volumeInfo$industryI2;\n            const response = await fetch(`https://www.googleapis.com/books/v1/volumes?q=isbn:${isbn}`);\n            if (!response.ok) {\n              throw new Error(`APIリクエストに失敗しました: ${response.statusText}`);\n            }\n            const data = await response.json();\n            if (!data.items || data.items.length === 0) {\n              console.warn(`⚠️ ISBN ${isbn} の書籍情報が見つかりませんでした。`);\n              return null;\n            }\n            const volume = data.items[0];\n            const volumeInfo = volume.volumeInfo;\n\n            // 表紙画像のURLを取得（大きいサイズを優先）\n            const coverUrl = ((_volumeInfo$imageLink = volumeInfo.imageLinks) === null || _volumeInfo$imageLink === void 0 ? void 0 : _volumeInfo$imageLink.large) || ((_volumeInfo$imageLink2 = volumeInfo.imageLinks) === null || _volumeInfo$imageLink2 === void 0 ? void 0 : _volumeInfo$imageLink2.medium) || ((_volumeInfo$imageLink3 = volumeInfo.imageLinks) === null || _volumeInfo$imageLink3 === void 0 ? void 0 : _volumeInfo$imageLink3.thumbnail) || ((_volumeInfo$imageLink4 = volumeInfo.imageLinks) === null || _volumeInfo$imageLink4 === void 0 ? void 0 : _volumeInfo$imageLink4.smallThumbnail) || \"\";\n\n            // ISBNを取得（industryIdentifiersから）\n            const isbn13 = ((_volumeInfo$industryI = volumeInfo.industryIdentifiers) === null || _volumeInfo$industryI === void 0 ? void 0 : (_volumeInfo$industryI2 = _volumeInfo$industryI.find(id => id.type === \"ISBN_13\")) === null || _volumeInfo$industryI2 === void 0 ? void 0 : _volumeInfo$industryI2.identifier) || isbn;\n            return {\n              isbn: isbn13,\n              title: volumeInfo.title || \"\",\n              author: (volumeInfo.authors || []).join(\", \") || \"不明\",\n              publisher: volumeInfo.publisher || \"\",\n              pubdate: volumeInfo.publishedDate || \"\",\n              cover: coverUrl.replace(\"&edge=curl\", \"\"),\n              // edge=curlパラメータを削除\n              summary: volumeInfo.description || \"\"\n            };\n          } catch (err) {\n            console.error(`❌ ISBN ${isbn} の取得に失敗しました:`, err);\n            return null;\n          }\n        });\n        const bookResults = await Promise.all(bookPromises);\n        const validBooks = bookResults.filter(book => book !== null);\n        console.log(\"✅ 書籍データ取得成功:\", validBooks.length, \"件\");\n        setBooks(validBooks);\n      } catch (err) {\n        console.error(\"❌ 書籍データの取得に失敗しました:\", err);\n        setError(err instanceof Error ? err.message : \"不明なエラーが発生しました\");\n        setBooks([]);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    fetchBooks();\n  }, []);\n  return {\n    books,\n    isLoading,\n    error\n  };\n}\n_s(useRecentBooks, \"IQ++4uVhX3pSOrUcIUrjuYAPPSo=\");","map":{"version":3,"names":["useState","useEffect","recentBookISBNs","useRecentBooks","_s","books","setBooks","isLoading","setIsLoading","error","setError","fetchBooks","length","bookPromises","map","isbn","_volumeInfo$imageLink","_volumeInfo$imageLink2","_volumeInfo$imageLink3","_volumeInfo$imageLink4","_volumeInfo$industryI","_volumeInfo$industryI2","response","fetch","ok","Error","statusText","data","json","items","console","warn","volume","volumeInfo","coverUrl","imageLinks","large","medium","thumbnail","smallThumbnail","isbn13","industryIdentifiers","find","id","type","identifier","title","author","authors","join","publisher","pubdate","publishedDate","cover","replace","summary","description","err","bookResults","Promise","all","validBooks","filter","book","log","message"],"sources":["/Users/shiwa/Desktop/wanttodev.com/src/hooks/useRecentBooks.ts"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { recentBookISBNs } from \"../data/recentBooks\";\n\n// Google Books APIのレスポンス型定義\ninterface GoogleBooksResponse {\n  kind: string;\n  totalItems: number;\n  items?: Array<{\n    id: string;\n    volumeInfo: {\n      title: string;\n      subtitle?: string;\n      authors?: string[];\n      publisher?: string;\n      publishedDate?: string;\n      description?: string;\n      imageLinks?: {\n        smallThumbnail?: string;\n        thumbnail?: string;\n        small?: string;\n        medium?: string;\n        large?: string;\n        extraLarge?: string;\n      };\n      industryIdentifiers?: Array<{\n        type: string;\n        identifier: string;\n      }>;\n    };\n  }>;\n}\n\n// コンポーネントで使用する書籍情報の型\nexport interface BookInfo {\n  isbn: string;\n  title: string;\n  author: string;\n  publisher: string;\n  pubdate: string;\n  cover: string;\n  summary: string;\n}\n\nexport function useRecentBooks() {\n  const [books, setBooks] = useState<BookInfo[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    const fetchBooks = async () => {\n      if (recentBookISBNs.length === 0) {\n        setIsLoading(false);\n        return;\n      }\n\n      try {\n        setIsLoading(true);\n        setError(null);\n\n        // Google Books APIを呼び出し（各ISBNを個別に取得）\n        const bookPromises = recentBookISBNs.map(async (isbn) => {\n          try {\n            const response = await fetch(\n              `https://www.googleapis.com/books/v1/volumes?q=isbn:${isbn}`\n            );\n\n            if (!response.ok) {\n              throw new Error(`APIリクエストに失敗しました: ${response.statusText}`);\n            }\n\n            const data: GoogleBooksResponse = await response.json();\n\n            if (!data.items || data.items.length === 0) {\n              console.warn(`⚠️ ISBN ${isbn} の書籍情報が見つかりませんでした。`);\n              return null;\n            }\n\n            const volume = data.items[0];\n            const volumeInfo = volume.volumeInfo;\n\n            // 表紙画像のURLを取得（大きいサイズを優先）\n            const coverUrl =\n              volumeInfo.imageLinks?.large ||\n              volumeInfo.imageLinks?.medium ||\n              volumeInfo.imageLinks?.thumbnail ||\n              volumeInfo.imageLinks?.smallThumbnail ||\n              \"\";\n\n            // ISBNを取得（industryIdentifiersから）\n            const isbn13 = volumeInfo.industryIdentifiers?.find(\n              (id) => id.type === \"ISBN_13\"\n            )?.identifier || isbn;\n\n            return {\n              isbn: isbn13,\n              title: volumeInfo.title || \"\",\n              author: (volumeInfo.authors || []).join(\", \") || \"不明\",\n              publisher: volumeInfo.publisher || \"\",\n              pubdate: volumeInfo.publishedDate || \"\",\n              cover: coverUrl.replace(\"&edge=curl\", \"\"), // edge=curlパラメータを削除\n              summary: volumeInfo.description || \"\",\n            };\n          } catch (err) {\n            console.error(`❌ ISBN ${isbn} の取得に失敗しました:`, err);\n            return null;\n          }\n        });\n\n        const bookResults = await Promise.all(bookPromises);\n        const validBooks = bookResults.filter(\n          (book): book is BookInfo => book !== null\n        );\n\n        console.log(\"✅ 書籍データ取得成功:\", validBooks.length, \"件\");\n        setBooks(validBooks);\n      } catch (err) {\n        console.error(\"❌ 書籍データの取得に失敗しました:\", err);\n        setError(\n          err instanceof Error ? err.message : \"不明なエラーが発生しました\"\n        );\n        setBooks([]);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchBooks();\n  }, []);\n\n  return { books, isLoading, error };\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}